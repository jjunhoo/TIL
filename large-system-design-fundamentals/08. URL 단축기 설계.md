## URL 단축기 설계

### 1단계 : 문제 이해 및 설계 범위 확정

- 쓰기 연산 - 매일 1억개의 단축 URL 생성
  - 초당 쓰기 연산 : `1억/24/3600 = 1160`
- URL 단축 서비스 10년간 운영 가정
  - `1억 * 365 * 10 = 3650억` 개 레코드 보관 필요
- 축약 전 URL 평균 길이 100byte
  - 즉, 10년 동안 필요한 저장 용량 : `3650억 * 100 = 36.5TB`

### 2단계 - 개략적 설계안 제시 및 동의 구하기

> API 엔드포인트

- URL 단축기는 기본적으로 2개의 엔드포인트 필요

1. URL 단축용 End-Point
   - 새 단축 URL을 생성하고자 할 때, 단축할 URL을 인자로 넣어 POST 요청

2. URL 리다이렉션 End-Point
   - 단축 URL에 대해 HTTP 요청이 오면 원래의 URL로 보내주기 위해 리다이렉션 URL 반환

> URL Redirection

- HTTP 에서 Redirection 에 관한 Status, Header 제공

[301 Moved Permanently](https://developer.mozilla.org/ko/docs/Web/HTTP/Status/301)
> 요청한 리소스가 Location 헤더에 주어진 URL 로 완전히 옮겨졌다는 것을 나타낸다. 브라우저는 이 페이지로 리다이렉트하고, 검색 엔진은 해당 리소스로 연결되는 링크를 갱신한다. 검색 엔진 최적화의 관점에서는 '원 콘텐츠가 새로운 URL 로 옮겨졌다'(the link-juice is sent to the new URL)고 한다.

- 영구적으로 이전 되었음으로 브라우저에서는 이 응답을 캐시한다. 즉, 단축 URL 로의 request 를 받았을 때 캐시된 데이터가 있다면, 브라우저는 원래 URL 로 요청을 보내게 된다.
- 단축 URL 서버 부하를 줄이고 싶은 경우, 301을 사용하는 것이 좋을 수 있다.

[302 Found](https://developer.mozilla.org/ko/docs/Web/HTTP/Status/302)
> 요청한 리소스가 Location 헤더에 주어진 URL에 일시적으로 이동되었음을 가리킨다. 브라우저는 사용자를 이 URL의 페이지로 리다이렉트시키지만 검색 엔진은 그 리소스가 일시적으로 이동되었다고 해서 그에 대한 링크를 갱신하지는 않는다. 'SEO 관점' 에서 말하자면, 링크 주스(Link Juice)가 새로운 URL로 보내지지는 않는다.

- 일시적으로 이전 됐음을 나타내므로 캐시되지 않는다. 즉, 단축 URL 로의 request 는 언제나 단축 URL 서버로 보내진 뒤 원래 URL 로 redirection 된다.
- 트래픽 분석 등 단축 URL 서버에서 모든 요청을 받아보는 것이 유의미한 경우, 302를 사용하는 것이 좋을 수 있다.
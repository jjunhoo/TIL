## 냄새 1. 이해하기 힘든 이름

> Mysterius Name 

- 깔끔한 코드에서 가장 중요한 것 중 하나는 바로 "좋은 이름"
- 함수, 변수, 클래스, 모듈의 이름 등 모두 어떤 역할을 하는지 어떻게 쓰이는지 직관적이어야 한다.
- 사용할 수 있는 리팩토링 기술
    - 함수 선언 변경하기 (Change Function Declaration)
    - 변수 이름 바꾸기 (Rename Variable)
    - 필드 이름 바꾸기 (Rename Field)

## 리팩토링 1. 함수 선언 변경하기

> 함수 이름 변경하기, 메소드 이름 변경하기, 매개변수 추가하기, 매개변수 제거하기, 시그니처 변경하기

- 좋은 이름을 가진 함수는 함수가 어떻게 구현되었는지 코드를 보지 않아도 이름만 보고 이해할 수 있다.
- 좋은 이름을 찾아내는 방법 ? 
    - 함수에 주석을 작성한 다음, 주석을 함수 이름으로 만들어 본다.
- 함수의 매개변수는 
    - 함수 내부의 문맥을 결정한다. (예 : 전화번호 포맷팅 함수)
    - 의존성을 결정한다. (예 : Payment 만기일 계산 함수)
    
````java
// whiteship/live-study 의 30번 이슈에 리뷰 정보를 출력
// 함수 선언 변경하기 > 리팩토링 전
public class StudyDashboard {
    
    private Set<String> usernames = new HashSet<>();
    private Set<String> reviews = new HashSet<>();
    
    // TODO : 리뷰 정보를 가져오는 목적으로 보다 직관적이고, 이해하기 쉽게 rename
    private void studyReviews(GHIssue issue) throws IOException {
        List<GHIssueComment> comments = issue.getComments();
        for (GHIssueComment comment : comments) {
            usernames.add(comment.getUserName());
            reviews.add(comment.getBody());
        }
    }
    
    public Set<String> getUsernames() { return usernames; }
    public Set<String> getReviews() { return reviews; }
    
    public static void main(String[] args) throws IOException {
        GitHub gitHub = GitHub.connect();
        GHRepository repository = gitHub.getRepository("whiteship/live-study");
        GHIssue issue = repository.getIssue(30); // TODO : 이슈는 '30'에만 있기 때문에 studyReviews 메소드로 옮겨도 무방
        
        StudyDashboard studyDashboard = new StudyDashboard();
        studyDashboard.studyReviews(issue);
        studyDashboard.getUsernames().forEach(System.out::println);
        studyDashboard.getReviews().forEach(System.out::println);
    }
}
````

````java
// whiteship/live-study 의 30번 이슈에 리뷰 정보를 출력
// 함수 선언 변경하기 > 리팩토링 후
public class StudyDashboard {
    
    private Set<String> usernames = new HashSet<>();
    private Set<String> reviews = new HashSet<>();
    
    /**
     * 스터디 리뷰 이슈에 작성되어 있는 리뷰어 목록과 리뷰를 읽어온다. 
     * @throws IOException
     */
    private void loadReviews() throws IOException { // 리팩토링 : 메소드명, 파라미터 제거
        // 리팩토링 : 30번 이슈에만 리뷰가 있기 때문에 굳이 parameter로 받지 않고 고정
        GitHub gitHub = GitHub.connect();
        GHRepository repository = gitHub.getRepository("whiteship/live-study");
        GHIssue issue = repository.getIssue(30);
        
        List<GHIssueComment> comments = issue.getComments();
        for (GHIssueComment comment : comments) {
            usernames.add(comment.getUserName());
            reviews.add(comment.getBody());
        }
    }
    
    public Set<String> getUsernames() { return usernames; }
    public Set<String> getReviews() { return reviews; }
    
    public static void main(String[] args) throws IOException {
        StudyDashboard studyDashboard = new StudyDashboard();
        studyDashboard.studyReviews(); // 리팩토링 : 파라미터 제거
        studyDashboard.getUsernames().forEach(System.out::println);
        studyDashboard.getReviews().forEach(System.out::println);
    }
}
````

## 리팩토링 2. 변수 이름 바꾸기

- 많이 사용되는 변수일수록 그 이름이 더 중요하다.
    - 람다식에서 사용하는 변수 vs 함수의 매개변수
- 다이나믹 타입을 지원하는 언어에서는 타입을 이름에 넣기도 한다.
- 여러 함수에 걸쳐 쓰이는 필드 이름에는 더 많이 고민하고 이름을 짓는다.

> 다이나믹 타입 : 컴파일 시 자료형을 정하는 것이 아니라 런타임 시 결정
````javascript
// 첫 번째 줄에서는 변수 num 이 숫자형으로 선언
// 두 번째 줄에서는 변수 num 이 문자형으로 선언 
def num = 123 // groovy 에서는 타입이 정해지지 않은 변수를 선언할 때 def 사용 
num = "일이삼"
````

````java
// 변수 이름 바꾸기 > 리팩토링 전
public class StudyDashboard {
    
    private Set<String> usernames = new HashSet<>();
    private Set<String> reviews = new HashSet<>();
    
    /**
     * 스터디 리뷰 이슈에 작성되어 있는 리뷰어 목록과 리뷰를 읽어온다. 
     * @throws IOException
     */
    private void loadReviews() throws IOException {
        GitHub gitHub = GitHub.connect();
        GHRepository repository = gitHub.getRepository("whiteship/live-study");
        GHIssue issue = repository.getIssue(30);
        
        // TODO : 메소드 기능 자체가 리뷰를 읽어오는 것이기 때문에 Comment 라는 네이밍 보다 review 라는 네이밍이 조금 더 적절
        List<GHIssueComment> comments = issue.getComments();
        for (GHIssueComment comment : comments) {
            usernames.add(comment.getUserName());
            reviews.add(comment.getBody());
        }
    }
    
    public Set<String> getUsernames() { return usernames; }
    public Set<String> getReviews() { return reviews; }
    
    public static void main(String[] args) throws IOException {
        StudyDashboard studyDashboard = new StudyDashboard();
        studyDashboard.loadReviews();
        studyDashboard.getUsernames().forEach(name -> System.out.println(name));
        studyDashboard.getReviews().forEach(review -> System.out.println(review));
    }
}
````

````java
// 변수 이름 바꾸기 > 리팩토링 후
public class StudyDashboard {
    
    private Set<String> usernames = new HashSet<>();
    private Set<String> reviews = new HashSet<>();
    
    /**
     * 스터디 리뷰 이슈에 작성되어 있는 리뷰어 목록과 리뷰를 읽어온다. 
     * @throws IOException
     */
    private void loadReviews() throws IOException {
        GitHub gitHub = GitHub.connect();
        GHRepository repository = gitHub.getRepository("whiteship/live-study");
        GHIssue issue = repository.getIssue(30);
        
        // 리팩토링 : Comment -> reviews
        List<GHIssueComment> reviews = issue.getComments();
        for (GHIssueComment review : reviews) {
            usernames.add(review.getUserName());
            this.reviews.add(review.getBody());
        }
    }
    
    public Set<String> getUsernames() { return usernames; }
    public Set<String> getReviews() { return reviews; }
    
    public static void main(String[] args) throws IOException {
        StudyDashboard studyDashboard = new StudyDashboard();
        studyDashboard.loadReviews();
        studyDashboard.getUsernames().forEach(name -> System.out.println(name));
        studyDashboard.getReviews().forEach(review -> System.out.println(review));
    }
}
````

## 리팩토링 3. 필드 이름 바꾸기

- Record 자료 구조의 필드 이름은 프로그램 전반에 걸쳐 참조될 수 있기 때문에 매우 중요하다.
    - Record 자료 구조 : 특정 데이터와 관련있는 필드를 묶어놓은 자료 구조
    - 파이썬의 Dictionary, 또는 줄여서 dicts
    - C#의 Record
    - 자바 14 버전부터 지원 (record 키워드)
        - 기존 DTO, VO 와 비슷한 개념 (* record 키워드를 사용하면, Immutable 한 특징이 있음)
        ````java
        public record StudyReview (String reviewer, String review) {
              // 생성자 자동 생성
              // Getter() 자동 생성
              // Hashcode, Equals, toString 생성
        }
        ````
    - 자바에서는 Getter와 Setter 메소드 이름도 필드의 이름과 비슷하게 간주할 수 있다.
    
````java
// 필드 이름 바꾸기 > 리팩토링 전
public class StudyDashboard {
    
    private Set<String> usernames = new HashSet<>();
    private Set<String> reviews = new HashSet<>();
    
    /**
     * 스터디 리뷰 이슈에 작성되어 있는 리뷰어 목록과 리뷰를 읽어온다. 
     * @throws IOException
     */
    private void loadReviews() throws IOException {
        GitHub gitHub = GitHub.connect();
        GHRepository repository = gitHub.getRepository("whiteship/live-study");
        GHIssue issue = repository.getIssue(30);
        
        List<GHIssueComment> reviews = issue.getComments();
        for (GHIssueComment review : reviews) {
            usernames.add(review.getUserName());
            this.reviews.add(review.getBody());
        }
    }
    
    public Set<String> getUsernames() { return usernames; }
    public Set<String> getReviews() { return reviews; }
    
    public static void main(String[] args) throws IOException {
        StudyDashboard studyDashboard = new StudyDashboard();
        studyDashboard.loadReviews();
        studyDashboard.getUsernames().forEach(name -> System.out.println(name));
        studyDashboard.getReviews().forEach(review -> System.out.println(review));
    }
}
````

````java
// 필드 이름 바꾸기 > 리팩토링 후
public record StudyReview (String reviewer, String review) { // 자바 14 이후부터 사용 가능
      // 생성자 자동 생성
      // Getter() 자동 생성
      // Hashcode, Equals, toString 생성
}
public class StudyDashboard {
    
    private Set<StudyReview> studyReviews = new HashSet<>();
    
    /**
     * 스터디 리뷰 이슈에 작성되어 있는 리뷰어 목록과 리뷰를 읽어온다. 
     * @throws IOException
     */
    private void loadReviews() throws IOException {
        GitHub gitHub = GitHub.connect();
        GHRepository repository = gitHub.getRepository("whiteship/live-study");
        GHIssue issue = repository.getIssue(30);
        
        List<GHIssueComment> reviews = issue.getComments();
        for (GHIssueComment review : reviews) {
            studyReview.add(new StudyReview(review.getUserName(), review.getBody()));
        }
    }
    
    public Set<StriStudyReviewng> getStudyReview() { 
        return studyReview; 
    }
    
    public static void main(String[] args) throws IOException {
        StudyDashboard studyDashboard = new StudyDashboard();
        studyDashboard.loadReviews();
        studyDashboard.getStudyReview().forEach(System.out::println);
    }
}
````